<!DOCTYPE html>
<html lang="ja" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>mri.com-user:dev:module</title>
<meta name="generator" content="DokuWiki"/>
<meta name="theme-color" content="#008800"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="mri.com-user,dev,module"/>
<!--[if gte IE 9]><!-->
<script >/*<![CDATA[*/var NS='mri.com-user:dev';var JSINFO = {"id":"mri.com-user:dev:module","namespace":"mri.com-user:dev","ACT":"export_xhtml","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<link rel="stylesheet" type="text/css" href="standard.css">
<script charset="utf-8" src="/~ocpublic/wiki/lib/exe/jquery.php?tseed=34a552433bc33cc9c3bc32527289a0b2" defer="defer"></script>
<script charset="utf-8" src="/~ocpublic/wiki/lib/exe/js.php?t=dokuwiki&amp;tseed=1ba1ca9e5699c4cd37eb1cb4bdf6d000" defer="defer"></script>
<!--<![endif]-->
</head>
<body>
<div class="dokuwiki export">
<div class="level1"><a href="index.html">MRI.COM</a></div>
<!-- TOC START -->
<div id="dw__toc" class="dw__toc">
<h3 class="toggle">目次</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="#mricom_モジュール作成">MRI.COM モジュール作成</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="#パッケージ型モジュール">パッケージ型モジュール</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="#内部変数">内部変数</a></div></li>
<li class="level3"><div class="li"><a href="#サブルーチン">サブルーチン</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="#定数参照型モジュール">定数参照型モジュール</a></div></li>
<li class="level2"><div class="li"><a href="#変数参照型モジュール">変数参照型モジュール</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="mricom_モジュール作成">MRI.COM モジュール作成</h1>
<div class="level1">

<p>
MRI.COMの各モジュールは、<a href="http://www.mri-jma.go.jp/Project/mrinpd/coderule.html" class="urlextern" title="http://www.mri-jma.go.jp/Project/mrinpd/coderule.html" rel="ugc nofollow">気象庁Fortran標準コーディングルール</a>の通常の「パッケージ型モジュール」、特別な「定数参照型モジュール」「変数参照型モジュール」のどれかに相当する。
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;MRI.COM \u30e2\u30b8\u30e5\u30fc\u30eb\u4f5c\u6210&quot;,&quot;hid&quot;:&quot;mricom_\u30e2\u30b8\u30e5\u30fc\u30eb\u4f5c\u6210&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-352&quot;} -->
<h2 class="sectionedit2" id="パッケージ型モジュール">パッケージ型モジュール</h2>
<div class="level2">

<p>
オブジェクト指向プログラミングを意識して作成する。
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;\u30d1\u30c3\u30b1\u30fc\u30b8\u578b\u30e2\u30b8\u30e5\u30fc\u30eb&quot;,&quot;hid&quot;:&quot;\u30d1\u30c3\u30b1\u30fc\u30b8\u578b\u30e2\u30b8\u30e5\u30fc\u30eb&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;353-476&quot;} -->
<h3 class="sectionedit3" id="内部変数">内部変数</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <code>save</code>属性の内部変数の設定はできるだけ <code>ini</code>, <code>prepare</code> に限る</div>
</li>
<li class="level1"><div class="li"> 仕方なくprepare以後に更新する場合は、必ずモジュール内部で行う (<code>protected</code>)</div>
</li>
<li class="level1"><div class="li"> 上位パッケージからの参照は可</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;\u5185\u90e8\u5909\u6570&quot;,&quot;hid&quot;:&quot;\u5185\u90e8\u5909\u6570&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;477-749&quot;} -->
<h3 class="sectionedit4" id="サブルーチン">サブルーチン</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <a href="./mri.com-user_dev_name_rule.html" class="wikilink1" title="mri.com-user_dev_name_rule" data-wiki-id="mri.com-user_dev_name_rule">命名規則</a>と<a href="./mri.com-user_dev_layer.html" class="wikilink1" title="mri.com-user_dev_layer" data-wiki-id="mri.com-user_dev_layer">階層構造</a>を踏まえて、なるべく共通の名前のサブルーチンを用意する</div>
</li>
<li class="level1 node"><div class="li"> 推奨されるサブルーチン</div>
<ul>
<li class="level2"><div class="li">  <code>ini</code> <code>prepare</code> <code>predict</code> <code>read_restart</code> <code>write_restart</code></div>
</li>
<li class="level2"><div class="li"> <code>write_history</code> 各モジュールが、自分が受け持つ情報についてモニタリングする</div>
</li>
</ul>
</li>
<li class="level1 node"><div class="li"> モジュール内サブルーチン(副プログラム)は、更にその内部に内部副プログラム(サブルーチン、関数)を持つことができる(<a href="https://www.nag-j.co.jp/fortran/FI_3.html" class="urlextern" title="https://www.nag-j.co.jp/fortran/FI_3.html" rel="ugc nofollow">Fortran入門</a>)</div>
<ul>
<li class="level2"><div class="li"> 内部副プログラムが内部副プログラムを持つことは不可</div>
</li>
<li class="level2"><div class="li"> SIMD化関数の場合は、内部副プログラムとしてではなく、同列のモジュール内関数とする方が安全のよう。</div>
</li>
</ul>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;\u30b5\u30d6\u30eb\u30fc\u30c1\u30f3&quot;,&quot;hid&quot;:&quot;\u30b5\u30d6\u30eb\u30fc\u30c1\u30f3&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:4,&quot;range&quot;:&quot;750-1602&quot;} -->
<h2 class="sectionedit5" id="定数参照型モジュール">定数参照型モジュール</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> 海洋モデルでは <code>param.F90</code> のみ</div>
</li>
<li class="level1"><div class="li"> 階層構造では最下位に位置する</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;\u5b9a\u6570\u53c2\u7167\u578b\u30e2\u30b8\u30e5\u30fc\u30eb&quot;,&quot;hid&quot;:&quot;\u5b9a\u6570\u53c2\u7167\u578b\u30e2\u30b8\u30e5\u30fc\u30eb&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:5,&quot;range&quot;:&quot;1603-1741&quot;} -->
<h2 class="sectionedit6" id="変数参照型モジュール">変数参照型モジュール</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> <code>common.F90</code> <code>tracer_vars.F90</code> など</div>
</li>
<li class="level1"><div class="li"> 時間ステップ毎に予測される、物理の状態変数に限定する</div>
</li>
<li class="level1"><div class="li"> 上位パッケージによる更新が可</div>
</li>
</ul>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;\u5909\u6570\u53c2\u7167\u578b\u30e2\u30b8\u30e5\u30fc\u30eb&quot;,&quot;hid&quot;:&quot;\u5909\u6570\u53c2\u7167\u578b\u30e2\u30b8\u30e5\u30fc\u30eb&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:6,&quot;range&quot;:&quot;1742-&quot;} --></div>
</body>
</html>
